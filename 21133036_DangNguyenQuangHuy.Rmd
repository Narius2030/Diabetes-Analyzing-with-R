---
title: "BaiTapKiemDinhGiaThuyet"
author: "21133036_DangNguyenQuangHuy"
date: "2023-12-16"
output: html_document
---

```{r}
install.packages("readr")
install.packages("ggplot2")
```

```{r}
library("readr")
library("ggplot2")
```

## Step 1 Import dữ liệu
```{r}
df <- read.csv('gdp_danh_nghia_theo_quy.csv', fileEncoding = "UTF-16LE", sep="\t");
df
```
## Step 2 Xử lí dữ liệu và kiểm định giả thuyết thống kê
```{r}
#Chuyển kiểu dữ liệu sang kiểu số

num_columns <- ncol(df)
for (i in 2:ncol(df)) {
  for (j in 1:nrow(df)) {
    df[j, i] <- as.numeric(gsub(",", "", df[j, i]))
  }
}
for (i in 2:ncol(df)) {
  df[, i] <- as.numeric(df[, i])
}
str(df)
```
*Trích lọc dữ liệu *

```{r}
xay_dung <- df[10,2:ncol(df)]
dich_vu <- df[11,2:ncol(df)]
```

*kết hợp thành 1 dataframe *

```{r}
df_combined <- rbind(xay_dung, dich_vu)
df_combined
```

 *Đặt giả thuyết và đối thiết*
 Giả thiết : H0=  tốc độ tăng trưởng của các lĩnh vực xây dựng và dịch vụ là giống nhau
 Đối thiết : H1 = tốc độ tăng trưởng của các lĩnh vực xây dựng và dịch vụ là khác nhau

```{r}

# Tạo dữ liệu giả định
xay_dung <- df[10, 2:ncol(df)]
dich_vu <- df[11, 2:ncol(df)]

# Thực hiện kiểm định t-test
result <- t.test(xay_dung, dich_vu)

# In kết quả
print(result)

```
*Kết quả kiểm tra t Welch Two Sample cho thấy sự khác biệt có ý nghĩa thống kê giữa các phương tiện của các nhóm "xay_dung" (Xây dựng) và "dich_vu" (Dịch vụ). Dưới đây là một số điểm chính từ đầu ra:*

*1. **t-statistic**: Giá trị t là -12.447, cho thấy sự khác biệt đáng kể giữa giá trị trung bình của hai nhóm.*

*2. **Độ tự do (df)**: Mức độ tự do xấp xỉ 35.919.*

*3. **p-value**: Giá trị p cực kỳ thấp (1.369e-14), nhỏ hơn nhiều so với mức ý nghĩa điển hình (ví dụ: 0.05). Điều này cho thấy bằng chứng mạnh mẽ bác bỏ giả thuyết H0 chấp nhận đối thuyết H1.*

*4. **Khoảng tin cậy **: Khoảng tin cậy 95% cho sự khác biệt về phương tiện là (-698991.9, -503111.8). Khoảng thời gian này không chứa số không, hỗ trợ thêm bằng chứng về sự khác biệt đáng kể.*

*5. **Ước tính mẫu**: Giá trị trung bình của "xay_dung" là 99795.17 và giá trị trung bình của "dich_vu" là 700847.06.*

**Kết thúc:**
*Giá trị p là cực kỳ nhỏ, cho thấy bằng chứng mạnh mẽ để bác bỏ giả thuyết tốc độ tăng trưởng của các lĩnh vực xây dựng và dịch vụ là giống nhau. Do đó, dựa trên thử nghiệm này, chúng ta có thể kết luận rằng có sự khác biệt có ý nghĩa thống kê về tốc độ tăng trưởng giữa các lĩnh vực Xây dựng và Dịch vụ(Chấp nhận đối thuyết ). dựa trên giá trị trung bình và khoảng tin cậy cho thấy ngành xây dựng có tốc độ tăng trưởng thấp hơn ngành dịch vụ*


```{r}
for (col in colnames(df)) {
  # Tạo dataframe mới từ cột hiện tại
  data <- data.frame(
    group = df$X,
    value = df[, col]
  )

  # Vẽ biểu đồ cột và ẩn nhãn trên trục x
  print(ggplot(data, aes(x = group, y = value, fill = group)) +
    geom_col(width = 1, color = "white") +
    theme_minimal() +
    theme(axis.text.x = element_blank(), axis.title.x = element_blank()) +
    ggtitle(paste("Distribution of", col)))
}

```

*Các ngành công nghiệp khác có mức tăng trưởng gần giống với xây dựng*

